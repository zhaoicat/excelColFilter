# Excel 列过滤工具 - EXE 版本使用说明

## 📦 打包信息

- **可执行文件**: `dist/ExcelColumnFilter.exe`
- **文件大小**: 约 40MB
- **运行环境**: Windows 10/11 (无需安装 Python)
- **打包工具**: PyInstaller 6.14.0

## 🚀 快速开始

### 1. 基本使用

```bash
# 查看帮助信息
ExcelColumnFilter.exe --help

# 查看Excel文件的所有列
ExcelColumnFilter.exe -i input.xls --list-columns

# 按列序号导出（导出第1,2,5列）
ExcelColumnFilter.exe -i input.xls -o output.xlsx -c "1,2,5"

# 按列名导出
ExcelColumnFilter.exe -i input.xls -o output.xlsx -c "编号,平台,站点,店铺名称"

# 导出所有列
ExcelColumnFilter.exe -i input.xls -o output.xlsx -c "all"
```

### 2. 高级功能

```bash
# 导出范围列（第10-15列）
ExcelColumnFilter.exe -i input.xls -o output.xlsx -c "10-15"

# 混合选择（第1,2列和第10-15列）
ExcelColumnFilter.exe -i input.xls -o output.xlsx -c "1,2,10-15"

# 导出并下载商品图片
ExcelColumnFilter.exe -i input.xls -o output.xlsx -c "编号,商品图片,商品标题" --download-images
```

## 📋 命令行参数

| 参数                | 简写 | 说明                | 示例                |
| ------------------- | ---- | ------------------- | ------------------- |
| `--input`           | `-i` | 输入 Excel 文件路径 | `-i data.xls`       |
| `--output`          | `-o` | 输出 Excel 文件路径 | `-o result.xlsx`    |
| `--columns`         | `-c` | 要导出的列          | `-c "1,2,5"`        |
| `--list-columns`    | 无   | 仅显示所有可用列    | `--list-columns`    |
| `--download-images` | 无   | 下载商品图片        | `--download-images` |
| `--help`            | `-h` | 显示帮助信息        | `--help`            |

## 🎯 列选择格式

### 1. 按序号选择

- **单个列**: `"1"` (第 1 列)
- **多个列**: `"1,2,5"` (第 1,2,5 列)
- **范围列**: `"10-15"` (第 10 到 15 列)
- **混合选择**: `"1,2,10-15,20"` (第 1,2 列，第 10-15 列，第 20 列)

### 2. 按列名选择

- **单个列**: `"编号"`
- **多个列**: `"编号,平台,站点"`
- **包含空格的列名**: `"店铺名称,商品标题"`

### 3. 特殊选择

- **所有列**: `"all"`

## 🖼️ 图片下载功能

当使用 `--download-images` 参数时：

1. **自动识别图片列**: 程序会自动查找名为"商品图片"、"图片"或"商品图片链接"的列
2. **并行下载**: 使用多线程并行下载，提高效率
3. **图片保存**: 下载的图片保存在 `images/` 目录中
4. **Excel 预览**: 在 Excel 文件中插入图片预览（缩略图）
5. **支持格式**: JPG, PNG, GIF, WebP

## 📁 文件结构

```
项目目录/
├── dist/
│   └── ExcelColumnFilter.exe    # 可执行文件
├── images/                      # 下载的图片目录（自动创建）
├── input.xls                   # 输入文件
└── output.xlsx                 # 输出文件
```

## ⚠️ 注意事项

### 1. 文件格式支持

- **输入格式**: `.xls`, `.xlsx`
- **输出格式**: `.xlsx`

### 2. 数据处理

- **长数字保护**: 自动处理订单号、商品 ID 等长数字，避免科学计数法
- **文本格式**: ID 类列自动设置为文本格式
- **空值处理**: 自动处理空值和 NaN 值

### 3. 性能优化

- **内存管理**: 大文件处理时注意内存使用
- **图片下载**: 默认最多 8 个并发下载线程
- **文件大小**: exe 文件约 40MB，首次运行可能较慢

### 4. 错误处理

- **文件不存在**: 会提示文件路径错误
- **列不存在**: 会警告不存在的列名
- **网络错误**: 图片下载失败会继续处理其他图片

## 🔧 故障排除

### 1. 常见问题

**Q: exe 文件运行很慢？**
A: 首次运行需要解压内置的 Python 环境，后续运行会快很多。

**Q: 提示"文件不存在"？**
A: 检查输入文件路径是否正确，支持相对路径和绝对路径。

**Q: 图片下载失败？**
A: 检查网络连接，某些图片链接可能已失效。

**Q: Excel 文件打开显示科学计数法？**
A: 程序已自动处理，如仍有问题，请检查 Excel 的单元格格式。

### 2. 性能建议

- 对于大文件（>1000 行），建议先使用 `--list-columns` 查看列信息
- 图片下载功能适合小批量数据，大量图片建议分批处理
- 输出文件建议使用 `.xlsx` 格式以获得最佳兼容性

## 📞 技术支持

如遇到问题，请提供以下信息：

1. 输入文件格式和大小
2. 使用的完整命令
3. 错误信息截图
4. Windows 版本信息

---

**版本**: 1.0.0  
**更新时间**: 2024 年 12 月  
**兼容性**: Windows 10/11
